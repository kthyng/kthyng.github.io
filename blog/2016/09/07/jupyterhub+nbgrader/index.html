
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Kristen M. Thyng, Ph.D. : How to use JupyterHub with nbgrader</title>
<link href="http://fonts.googleapis.com/css?family=Abel|Arvo" rel="stylesheet" type="text/css" />
<link rel="stylesheet" href="http://www.kristenthyng.com/blog/theme/css/styles.css" type="text/css" />

<link href="http://www.kristenthyng.com/blog/" type="application/atom+xml" rel="alternate" title="Kristen M. Thyng, Ph.D. ATOM Feed" />

<!--[if IE]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

<!--[if lte IE 7]>
        <link rel="stylesheet" type="text/css" media="all" href="http://www.kristenthyng.com/blog/css/ie.css"/>
        <script src="http://www.kristenthyng.com/blog/js/IE8.js" type="text/javascript"></script><![endif]-->

<!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" media="all" href="http://www.kristenthyng.com/blog/css/ie6.css"/><![endif]-->

</head>

<body>

<div id="container">
    <div id="header">
        <h1><a href="/index.html">Kristen M. Thyng<span>Ph.D. </span></a></h1>
        <div class="submenu">
            <ul>
                <li><a href="../blog/index.html">Blog</a></li>
                <li><a href="../research.html">Research</a></li>
                <li><a href="../publications.html">Publications</a></li>
                <li><a href="../cv.pdf">CV</a></li><br>
                <li><a href="../presentations.html">Presentations</a></li>
                <li><a href="../teaching.html">Teaching</a></li>
                <li><a href="../gallery.html">Gallery</a></li>
            </ul>
        </div>
        <div class="clearfloat"></div>
<!--         <div id="navcontainer">
            <ul id="navlist">
                <li id="active"><a href="#">Home</a></li>
                <li><a href="research.html">Research</a></li>
                <li><a href="publications.html">Publications</a></li>
                <li><a href="teaching.html">Teaching</a></li>
                <li><a href=""></a></li>
            </ul>
        </div> -->
<!--         <div class="clearfloat"></div>
        <div><img src="http://www.kristenthyng.com/blog/theme/images/header.jpg" alt="" width=100% /></div> -->
    </div>
        
<header>
    <h2>How to use JupyterHub with nbgrader</h2>
<time datetime="2016-09-07T11:00:00-05:00">Sep 07, 2016</time></header>
<br>
<article>
    <p>I am teaching for the second time a class on Python â€” <a href="https://github.com/kthyng/python4geosciences">Python for the Geosciences</a>. It went well last semester, but I felt that too much time was spent on getting stuff installed on student machines, despite using Anaconda. (Much of this was due to Mac vs. PC behaviors.) This semester, I am trying to avoid installation issues on the student end by having them sign into a JupyterHub server, which is being run off a local workstation. I like it for the most part, though installation issues have not been trivial, particularly in coordinating JupyterHub and nbgrader, the really nice setup for distributing assignments to students so that they can work on them, check their work, and submit them, and so that I can subsequently grade them easily. I graded submitted notebooks "by hand" last semester and it was a nightmare, so avoiding that was a big goal this semester.
<br><br>
As far as I understand, one of the main pain points for getting this all to work is the fact that we are trying to stay more secure, with an <code>https</code> address for the server. I'll describe here the steps I took in case it might help future me or someone else out there. Note that I'm starting after the point of getting the JupyterHub server installed and setup.
<br><br><br></p>
<h1>Set up student accounts on workstation for server</h1>
<p><br><br>
With about 10 students in the class, it was annoying but not too hard to setup an account on the workstation for each of them. I used their student email nickname for their login, and made them part of a group so that I can use the group name for adding permissions and deleting them after the term is over. I chose their passwords for them since I wanted to be sure they had strong passwords. I am keeping track of them on my own (I use <a href="https://1password.com/">1password</a> to keep track of all this sort of thing, as well as generating passwords), and I read somewhere that sending someone a link to a public dropbox file is a relatively secure way to send information, so I made a file for each of them with their username and password and emailed it off.
<br><br></p>
<div class="highlight"><pre><span></span>sudo groupadd pythonfall2016  # create group
# home directory is on a separate drive on this workstation
sudo useradd -G pythonfall2016 -d /d2/home/student_username_here student_username_here
sudo passwd username  # give them each a good password
</pre></div>


<p><br><br>
I had to log into each account to set up a "notebooks" directory, which is where JupyterHub was setup to start. (This is controlled in your JuyterHub config file jupyterhub_config.py by the variable c.Spawner.notebook_dir = '~/notebooks'.)
<br><br>
I then added the group <code>pythonfall2016</code> to the authenticated list in jupyterhub_config.py so they would be able to log in: c.LocalAuthenticator.group_whitelist = {'pythonfall2016'}.
<br><br><br></p>
<h1>nbgrader</h1>
<h2>nbgrader_config file</h2>
<div class="highlight"><pre><span></span>c = get_config()

# You only need this if you are running nbgrader on a shared
# server set up.
c.NbGrader.course_id = &quot;ocng669&quot;

# Update this list with other assignments you want
c.NbGrader.db_assignments = [dict(name=&quot;hw1&quot;)]

# Change the students in this list with that actual students in
# your course
c.NbGrader.db_students = [
    dict(id=&quot;pythontest&quot;, first_name=&quot;P&quot;, last_name=&quot;pythontest&quot;),
    dict(id=&quot;ritvik&quot;, first_name=&quot;Ritvik&quot;, last_name=&quot;Dhupkar&quot;),
    dict(id=&quot;fiorenja&quot;, first_name=&quot;James&quot;, last_name=&quot;Fiorendino&quot;),
    dict(id=&quot;son536&quot;, first_name=&quot;Woongrak&quot;, last_name=&quot;Son&quot;),
    dict(id=&quot;shailavi&quot;, first_name=&quot;Lu&quot;, last_name=&quot;Sun&quot;),
    dict(id=&quot;sthapa&quot;, first_name=&quot;Shubhechchha&quot;, last_name=&quot;Thapa&quot;),
    dict(id=&quot;aeburgess&quot;, first_name=&quot;, Allyson&quot;, last_name=&quot;Lucchese&quot;),
    dict(id=&quot;fay155&quot;, first_name=&quot;Amanda&quot;, last_name=&quot;Sterne&quot;)
]

#------------------------------------------------------------------------------
# FormgradeApp configuration
#------------------------------------------------------------------------------

# IP address for the server
c.FormgradeApp.ip = &quot;127.0.0.1&quot;
# Port for the server
c.FormgradeApp.port = 5000 # 9000
# Authenticator used in all formgrade requests.
c.FormgradeApp.authenticator_class = &quot;nbgrader.auth.hubauth.HubAuth&quot;

# from https://groups.google.com/forum/#!topic/jupyter/oTRM4XuRUew
# for running with https
# this line made it so the page was rendered nicely and actually conntected
# to the class database properly (instead of the localhost)
c.HubAuth.hub_base_url = &quot;https://copano.tamu.edu:8000&quot;
c.HubAuth.notebook_url_prefix = &quot;ocng669&quot;
c.HubAuth.graders = [&quot;kthyng&quot;]

# The nbgrader exchange directory writable to everyone. MUST be preexisting.
# this is the default location for the exchange directory
c.TransferApp.exchange_directory = &#39;/srv/nbgrader/exchange&#39;
</pre></div>


<h2>getting the authorization token setup</h2>
<h2>Instructor end</h2>
<h2>Student end</h2>
<h2>Instructor end</h2>
<h2>Student end</h2>
</article>
<br>

<footer>
    <div id="footer">
        <nav>
            <br>
            <a href="http://www.kristenthyng.com/blog/index.html">Blog Home</a>&nbsp;&nbsp;
            <a href="http://www.kristenthyng.com/blog/archives.html">Archive</a>
            <ul>
<!--              -->
<!--                             <li>:: <a href="http://www.kristenthyng.com/blog/tags.html">Tags</a></li>
 -->
            </ul>
        </nav>
    </div>
</footer></div>

    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-43225108-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>
</body>
</html>